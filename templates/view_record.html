{% extends "base.html" %}
{% block title %}Detalhes{% endblock %}
{% block content %}
<h1>Registro: {{ rec['device_name'] }}</h1>
<p><a class="btn secondary" href="{{ url_for('my_device_detail', device_name=rec['device_name']) }}">Ver histórico deste dispositivo</a></p>
<p><strong>Fusões:</strong> {{ rec['fusion_count'] }}</p>
<p><strong>Criado em:</strong> {{ rec['created_at'] }}</p>
<div class="thumbs">
  {% if photos %}
    {% for p in photos %}
      <img class="zoomable" src="{{ url_for('uploaded_file', filename=p['filename']) }}" alt="foto" data-full="{{ url_for('uploaded_file', filename=p['filename']) }}">
    {% endfor %}
  {% else %}
    <p>Sem fotos anexadas.</p>
  {% endif %}
</div>

<div id="lightbox" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.85); align-items:center; justify-content:center; z-index:9999;">
  <img id="lightbox-img" src="" style="max-width:90%; max-height:90%; border-radius:8px;">
</div>
<script>
  document.querySelectorAll('.zoomable').forEach(img => {
    img.addEventListener('click', () => {
      document.getElementById('lightbox-img').src = img.dataset.full;
      document.getElementById('lightbox').style.display = 'flex';
    });
  });
  document.getElementById('lightbox').addEventListener('click', () => {
    document.getElementById('lightbox').style.display = 'none';
  });
</script>

<p><a class="btn secondary" href="{{ url_for('dashboard') }}">Voltar</a></p>
{% endblock %}
